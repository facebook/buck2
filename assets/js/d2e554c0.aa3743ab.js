"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[97941],{8768:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"prelude/rules/core/remote_file","title":"remote_file","description":"A remote_file() rule is used to download files from the Internet to be used as dependencies for other rules. These rules are downloaded by running fetch, or can be downloaded as part of build. See the note there about the .buckconfig setting to configure that.","source":"@site/../docs/prelude/rules/core/remote_file.md","sourceDirName":"prelude/rules/core","slug":"/prelude/rules/core/remote_file","permalink":"/docs/prelude/rules/core/remote_file","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"ruleSidebar","previous":{"title":"platform","permalink":"/docs/prelude/rules/core/platform"},"next":{"title":"test_suite","permalink":"/docs/prelude/rules/core/test_suite"}}');var r=s(74848),i=s(28453);s(56289);const l={},o="remote_file",d={},c=[{value:"Function Signature",id:"function-signature",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Examples",id:"examples",level:3}];function a(e){const n={a:"a",code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"remote_file",children:"remote_file"})}),"\n",(0,r.jsxs)(n.p,{children:["A ",(0,r.jsx)(n.code,{children:"remote_file()"})," rule is used to download files from the Internet to be used as dependencies for other rules. These rules are downloaded by running ",(0,r.jsx)(n.code,{children:"fetch"}),", or can be downloaded as part of ",(0,r.jsx)(n.code,{children:"build"}),". See the note there about the ",(0,r.jsx)(n.code,{children:".buckconfig"})," setting to configure that."]}),"\n",(0,r.jsx)(n.h3,{id:"function-signature",children:"Function Signature"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def remote_file(\n    *,\n    name: str,\n    default_target_platform: None | str = None,\n    target_compatible_with: list[str] = [],\n    compatible_with: list[str] = [],\n    exec_compatible_with: list[str] = [],\n    visibility: list[str] = [],\n    within_view: list[str] = ["PUBLIC"],\n    metadata: OpaqueMetadata = {},\n    tests: list[str] = [],\n    modifiers: OpaqueMetadata = [],\n    _apple_platforms: dict[str, str] = {},\n    _unzip_tool: str = "prelude//zip_file/tools:unzip",\n    contacts: list[str] = [],\n    default_host_platform: None | str = None,\n    labels: list[str] = [],\n    licenses: list[str] = [],\n    out: None | str = None,\n    sha1: None | str = None,\n    sha256: None | str = None,\n    size_bytes: None | int = None,\n    type: None | str = None,\n    url: str,\n    vpnless_url: None | str = None,\n) -> None\n'})}),"\n",(0,r.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"name"}),": (required)"]}),"\n",(0,r.jsx)(n.p,{children:"name of the target"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"default_target_platform"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"None"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"specifies the default target platform, used when no platforms are specified on the command line"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"target_compatible_with"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"[]"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"a list of constraints that are required to be satisfied for this target to be compatible with a configuration"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"compatible_with"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"[]"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"a list of constraints that are required to be satisfied for this target to be compatible with a configuration"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"exec_compatible_with"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"[]"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"a list of constraints that are required to be satisfied for this target to be compatible with an execution platform"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"visibility"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"[]"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"a list of visibility patterns restricting what targets can depend on this one"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"within_view"}),": (defaults to: ",(0,r.jsx)(n.code,{children:'["PUBLIC"]'}),")"]}),"\n",(0,r.jsx)(n.p,{children:"a list of visibility patterns restricting what this target can depend on"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"metadata"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"{}"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"a key-value map of metadata associated with this target"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"tests"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"[]"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"a list of targets that provide tests for this one"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"modifiers"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"[]"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"an array of modifiers associated with this target"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"contacts"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"[]"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"A list of organizational contacts for this rule. These could be individuals who you would contact in the event of a failure or other issue with the rule."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"contacts = [ 'Joe Sixpack', 'Erika Mustermann' ]\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"labels"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"[]"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["Set of arbitrary strings which allow you to annotate a ",(0,r.jsx)(n.a,{href:"https://buck2.build/docs/concepts/build_rule/",children:"build rule"})," with tags that can be searched for over an entire dependency tree using ",(0,r.jsx)(n.code,{children:"buck query()"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"licenses"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"[]"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["Set of license files for this library. To get the list of license files for a given build rule and all of its dependencies, you can use ",(0,r.jsx)(n.a,{href:"https://buck2.build/docs/users/commands/query/",children:"buck query"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"out"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"None"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["An optional name to call the downloaded artifact. Buck will generate a default name if one is not provided that uses the ",(0,r.jsx)(n.code,{children:"name"})," of the rule."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"size_bytes"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"None"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Size in bytes of the downloaded artifact. Buck verifies this is correct and fails the fetch command if it doesn't match (only when a SHA-1 hash is used)."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"type"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"None"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"An optional type of the downloaded file."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"data"}),"\nRegular data file.\n",(0,r.jsx)(n.code,{children:"executable"})]}),"\n",(0,r.jsx)(n.p,{children:"Executable file. Buck will ensure that output has appropriate permissions if applicable."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"exploded_zip"})}),"\n",(0,r.jsx)(n.p,{children:"Zip archive which will be automatically unzipped into an output directory."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"url"}),": (required)"]}),"\n",(0,r.jsxs)(n.p,{children:["You can specify an ",(0,r.jsx)(n.code,{children:"http"}),", ",(0,r.jsx)(n.code,{children:"https"}),", or a ",(0,r.jsx)(n.code,{children:"mvn"})," URL. If you specify a ",(0,r.jsx)(n.code,{children:"mvn"})," URL, it will be decoded as described in the javadocs for MavenUrlDecoder See the example section below."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"vpnless_url"}),": (defaults to: ",(0,r.jsx)(n.code,{children:"None"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"An optional additional URL from which this resource can be downloaded when off VPN. Meta-internal only."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,r.jsxs)(n.p,{children:["Here's an example of a ",(0,r.jsx)(n.code,{children:"remote_file()"})," using an ",(0,r.jsx)(n.code,{children:"https"})," URL."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"\nremote_file(\n  name = 'android-ndk-r10e-darwin-x86_64',\n  url = 'https://dl.google.com/android/ndk/android-ndk-r10e-darwin-x86_64.bin',\n  sha1 = 'b57c2b9213251180dcab794352bfc9a241bf2557',\n)\n\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Here's an example of a ",(0,r.jsx)(n.code,{children:"remote_file()"})," using a ",(0,r.jsx)(n.code,{children:"mvn"})," URL being referenced\nby a ",(0,r.jsx)(n.code,{children:"prebuilt_jar()"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"\nprebuilt_jar(\n  name = 'jetty-all',\n  binary_jar = 'jetty-all-9.2.10.v20150310.jar',\n  source_jar = ':jetty-source',\n)\n\nremote_file(\n  name = 'jetty-source',\n  out = 'jetty-all-9.2.10.v20150310-sources.jar',\n  url = 'mvn:org.eclipse.jetty.aggregate:jetty-all:src:9.2.10.v20150310',\n  sha1 = '311da310416d2feb3de227081d7c3f48742d7075',\n)\n\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Here's an example of a ",(0,r.jsx)(n.code,{children:"remote_file()"})," using a ",(0,r.jsx)(n.code,{children:"mvn"})," URI which uses a\nnon-default maven repository host."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"\nremote_file(\n  name = 'jetty-source',\n  out = 'jetty-all-9.2.10.v20150310-sources.jar',\n  url = 'mvn:https://maven-repo.com:org.eclipse.jetty.aggregate:jetty-all:src:9.2.10.v20150310',\n  sha1 = '311da310416d2feb3de227081d7c3f48742d7075',\n)\n\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Here's an example of a ",(0,r.jsx)(n.code,{children:"remote_file()"})," using a ",(0,r.jsx)(n.code,{children:"mvn"})," URI which uses a\nMaven classifier."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"\nremote_file(\n  name = 'groovy-groovysh-indy',\n  out = 'jetty-all-9.2.10.v20150310-sources.jar',\n  url = 'mvn:org.codehaus.groovy:groovy-groovysh:jar:indy:2.4.1',\n  sha1 = '1600fde728c885cc9506cb102deb1b494bd7c130',\n)\n\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var t=s(96540);const r={},i=t.createContext(r);function l(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);