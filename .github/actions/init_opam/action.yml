name: init_opam
description: |
  Setup OCaml environment for building and testing buck2.
runs:
  using: composite
  steps:
  - name: Init opam
    run: |-
      opam init --compiler=5.1.1 --disable-sandboxing -y
      opam install menhir ppxlib -y
    shell: bash
  - name: OCaml Configuration Info
    run: |
      eval $(opam env) >> $GITHUB_ENV
      ocamlopt.opt -config
    shell: bash
