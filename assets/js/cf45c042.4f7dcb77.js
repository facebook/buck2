"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[55650],{28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>d});var r=i(96540);const s={},l=r.createContext(s);function t(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(l.Provider,{value:n},e.children)}},36530:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"rule_authors/subdir_glob","title":"subdir_glob()","description":"The subdir_glob() function is a utility for creating dictionaries that map","source":"@site/../docs/rule_authors/subdir_glob.md","sourceDirName":"rule_authors","slug":"/rule_authors/subdir_glob","permalink":"/docs/rule_authors/subdir_glob","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"subdir_glob","title":"subdir_glob()"},"sidebar":"main","previous":{"title":"Alias","permalink":"/docs/rule_authors/alias"},"next":{"title":"Local Resources For Tests Execution","permalink":"/docs/rule_authors/local_resources"}}');var s=i(74848),l=i(28453);const t={id:"subdir_glob",title:"subdir_glob()"},d="subdir_glob()",c={},o=[{value:"Overview",id:"overview",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Arguments",id:"arguments",level:2},{value:"Return Value",id:"return-value",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"Examples",id:"examples",level:2},{value:"Basic C++ Header Mapping",id:"basic-c-header-mapping",level:3},{value:"Multiple Subdirectories with Prefix",id:"multiple-subdirectories-with-prefix",level:3},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Multiple File Types",id:"multiple-file-types",level:3},{value:"Excluding Test Files",id:"excluding-test-files",level:3}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"subdir_glob",children:"subdir_glob()"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"subdir_glob()"})," function is a utility for creating dictionaries that map\nrelative paths to source files, making it particularly useful for defining\nheader maps for C/C++ libraries and resource mappings for Android projects. For\nmore information, see ",(0,s.jsx)(n.a,{href:"/docs/api/build/#glob",children:(0,s.jsx)(n.code,{children:"glob()"})})]}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"subdir_glob()"})," takes a list of (subdirectory, glob-pattern) tuples and returns\na dictionary where:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Keys"})," are paths relative to the specified subdirectories"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Values"})," are the full paths to the matched files"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This is especially useful when you need to maintain a specific directory\nstructure in your build outputs, such as header include paths that should be\nrelative to a base directory."}),"\n",(0,s.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'subdir_glob(\n    glob_specs,\n    exclude = [],\n    prefix = "",\n)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"arguments",children:"Arguments"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"glob_specs"})})," (required): A list of tuples in the form\n",(0,s.jsx)(n.code,{children:"(relative-sub-directory, glob-pattern)"}),". Each tuple specifies:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A subdirectory path relative to the build file"}),"\n",(0,s.jsx)(n.li,{children:"A glob pattern to match files within that subdirectory"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"exclude"})})," (optional, defaults to ",(0,s.jsx)(n.code,{children:"[]"}),"): A list of patterns identifying\nfiles that should be excluded from the results."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"prefix"})})," (optional, defaults to ",(0,s.jsx)(n.code,{children:'""'}),"): A string to prepend to each key in\nthe resulting dictionary."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"return-value",children:"Return Value"}),"\n",(0,s.jsx)(n.p,{children:"Returns a dictionary mapping relative paths (with optional prefix) to full file\npaths."}),"\n",(0,s.jsx)(n.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,s.jsxs)(n.p,{children:["For each tuple ",(0,s.jsx)(n.code,{children:"(subdir, pattern)"})," in ",(0,s.jsx)(n.code,{children:"glob_specs"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Matches files using ",(0,s.jsx)(n.code,{children:"glob([subdir/pattern])"})]}),"\n",(0,s.jsxs)(n.li,{children:["Creates dictionary entries where:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Key = file path relative to ",(0,s.jsx)(n.code,{children:"subdir"})," (optionally prefixed)"]}),"\n",(0,s.jsx)(n.li,{children:"Value = full path to the file"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"If multiple tuples are provided, their results are merged into a single\ndictionary. If there are conflicting keys with different values, the function\nwill fail with an error."}),"\n",(0,s.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,s.jsx)(n.h3,{id:"basic-c-header-mapping",children:"Basic C++ Header Mapping"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'cxx_library(\n    name = "mylib",\n    exported_headers = subdir_glob([\n        ("include", "**/*.h"),\n    ]),\n)\n'})}),"\n",(0,s.jsx)(n.p,{children:"For this directory structure:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"include/\n  math/\n    vector.h\n    matrix.h\n  utils/\n    helpers.h\n"})}),"\n",(0,s.jsx)(n.p,{children:"This creates a mapping:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'{\n    "math/vector.h": "include/math/vector.h",\n    "math/matrix.h": "include/math/matrix.h",\n    "utils/helpers.h": "include/utils/helpers.h",\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Consumers can include headers as: ",(0,s.jsx)(n.code,{children:'#include "math/vector.h"'})]}),"\n",(0,s.jsx)(n.h3,{id:"multiple-subdirectories-with-prefix",children:"Multiple Subdirectories with Prefix"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'exported_headers = subdir_glob([\n    ("lib/source", "video/**/*.h"),\n    ("lib/source", "audio/**/*.h"),\n  ],\n  exclude = [\n    "lib/source/video/codecs/*.h",\n  ],\n  prefix = "MediaLib/")\n'})}),"\n",(0,s.jsx)(n.p,{children:"For this directory structure:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"lib/\n  source/\n    video/\n      converter/\n        converter.h\n      player/\n        player.h\n      codecs/\n        codec1.h   (excluded)\n        codec2.h   (excluded)\n    audio/\n      codecs/\n        codec1.h\n        codec2.h\n      player/\n        player.h\n    internal/\n      otherheader.h\n"})}),"\n",(0,s.jsx)(n.p,{children:"This creates a mapping:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'{\n    "MediaLib/video/converter/converter.h": "lib/source/video/converter/converter.h",\n    "MediaLib/video/player/player.h": "lib/source/video/player/player.h",\n    "MediaLib/audio/codecs/codec1.h": "lib/source/audio/codecs/codec1.h",\n    "MediaLib/audio/codecs/codec2.h": "lib/source/audio/codecs/codec2.h",\n    "MediaLib/audio/player/player.h": "lib/source/audio/player/player.h",\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Consumers can include headers as:\n",(0,s.jsx)(n.code,{children:'#include "MediaLib/video/converter/converter.h"'})]}),"\n",(0,s.jsx)(n.p,{children:"Note that:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Files in ",(0,s.jsx)(n.code,{children:"lib/source/video/codecs/"})," are excluded"]}),"\n",(0,s.jsxs)(n.li,{children:["Files in ",(0,s.jsx)(n.code,{children:"lib/source/internal/"})," are not matched by any pattern"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,s.jsx)(n.h3,{id:"multiple-file-types",children:"Multiple File Types"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'exported_headers = subdir_glob([\n    ("include", "**/*.h"),\n    ("include", "**/*.hpp"),\n])\n'})}),"\n",(0,s.jsx)(n.h3,{id:"excluding-test-files",children:"Excluding Test Files"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'headers = subdir_glob([\n    ("src", "**/*.h"),\n  ],\n  exclude = [\n    "src/**/*_test.h",\n    "src/test/**",\n  ])\n'})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);