"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[16086],{28453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>t});var l=n(96540);const o={},a=l.createContext(o);function i(e){const r=l.useContext(a);return l.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),l.createElement(a.Provider,{value:r},e.children)}},40876:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>s,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"bxl/how_tos/how_to_handle_errors","title":"How to Handle Errors","description":"This guide shows you how to handle failures in BXL script when running bxl","source":"@site/../docs/bxl/how_tos/how_to_handle_errors.md","sourceDirName":"bxl/how_tos","slug":"/bxl/how_tos/how_to_handle_errors","permalink":"/docs/bxl/how_tos/how_to_handle_errors","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"how_to_handle_errors","title":"How to Handle Errors"},"sidebar":"main","previous":{"title":"How to Cache and Share Operations","permalink":"/docs/bxl/how_tos/how_to_cache_and_share_operations"},"next":{"title":"How to Catch Building Artifacts Errors","permalink":"/docs/bxl/how_tos/how_to_catch_building_artifacts_errors"}}');var o=n(74848),a=n(28453);const i={id:"how_to_handle_errors",title:"How to Handle Errors"},t=void 0,s={},d=[{value:"Running Single Operations with Error Recovery",id:"running-single-operations-with-error-recovery",level:2},{value:"1. Create a lazy operation using the appropriate",id:"1-create-a-lazy-operation-using-the-appropriate",level:3},{value:"2. Add error handling and resolve the operation:",id:"2-add-error-handling-and-resolve-the-operation",level:3},{value:"Handling Multiple Operations in Parallel",id:"handling-multiple-operations-in-parallel",level:2},{value:"1. Create your lazy operations:",id:"1-create-your-lazy-operations",level:3},{value:"2. Choose your error handling approach:",id:"2-choose-your-error-handling-approach",level:3},{value:"For collective error handling (stop on first error):",id:"for-collective-error-handling-stop-on-first-error",level:4},{value:"For individual error handling per operation:",id:"for-individual-error-handling-per-operation",level:4},{value:"Examples",id:"examples",level:2}];function c(e){const r={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(r.p,{children:["This guide shows you how to handle failures in BXL script when running bxl\noperations, like analysis, queries, build artifact and other operations. You can\nfind all available operations at ",(0,o.jsx)(r.a,{href:"../../../api/bxl/LazyContext",children:"here"}),". You'll\nlearn how to recover from errors and running these operations in parallel."]}),"\n",(0,o.jsx)(r.h2,{id:"running-single-operations-with-error-recovery",children:"Running Single Operations with Error Recovery"}),"\n",(0,o.jsx)(r.p,{children:"To run a single operation with error handling:"}),"\n",(0,o.jsx)(r.h3,{id:"1-create-a-lazy-operation-using-the-appropriate",children:"1. Create a lazy operation using the appropriate"}),"\n",(0,o.jsxs)(r.p,{children:[(0,o.jsx)(r.a,{href:"../../../api/bxl/LazyContext",children:"ctx.lazy"})," method:"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-python",children:"lazy_analysis = ctx.lazy.analysis(node)\n"})}),"\n",(0,o.jsxs)(r.p,{children:["It will return a ",(0,o.jsx)(r.a,{href:"../../../api/bxl/Lazy",children:(0,o.jsx)(r.code,{children:"Lazy"})})," object."]}),"\n",(0,o.jsx)(r.h3,{id:"2-add-error-handling-and-resolve-the-operation",children:"2. Add error handling and resolve the operation:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-python",children:"result = lazy_analysis.catch().resolve()\n"})}),"\n",(0,o.jsxs)(r.p,{children:["The result will be of type\n",(0,o.jsx)(r.a,{href:"../../../api/bxl/Result",children:(0,o.jsx)(r.code,{children:"Result[bxl.AnalysisResult]"})}),", allowing you to check\nfor and handle errors."]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-python",children:"if result.is_ok():\n    analysis_res = result.unwrap()\nelse:\n    error = result.unwrap_err()\n"})}),"\n",(0,o.jsxs)(r.p,{children:["If resolving ",(0,o.jsx)(r.a,{href:"../../../api/bxl/Lazy",children:(0,o.jsx)(r.code,{children:"Lazy"})})," object without calling ",(0,o.jsx)(r.code,{children:"catch()"}),",\nit will return ",(0,o.jsx)(r.code,{children:"bxl.AnalysisResult"})," and the bxl script will fail if this\noperation fails."]}),"\n",(0,o.jsx)(r.h2,{id:"handling-multiple-operations-in-parallel",children:"Handling Multiple Operations in Parallel"}),"\n",(0,o.jsx)(r.p,{children:"To run multiple operations while handling potential failures:"}),"\n",(0,o.jsx)(r.h3,{id:"1-create-your-lazy-operations",children:"1. Create your lazy operations:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-python",children:"lazy_ops = [\n    ctx.lazy.analysis(node1),\n    ctx.lazy.analysis(node2),\n    ctx.lazy.configured_target_node(target1)\n]\n"})}),"\n",(0,o.jsx)(r.h3,{id:"2-choose-your-error-handling-approach",children:"2. Choose your error handling approach:"}),"\n",(0,o.jsx)(r.h4,{id:"for-collective-error-handling-stop-on-first-error",children:"For collective error handling (stop on first error):"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-python",children:"result = ctx.lazy.join_all(lazy_ops).catch().resolve()\n"})}),"\n",(0,o.jsxs)(r.p,{children:["The Return type is ",(0,o.jsx)(r.code,{children:"Result[list[bxl.AnalysisResult]]"})]}),"\n",(0,o.jsx)(r.h4,{id:"for-individual-error-handling-per-operation",children:"For individual error handling per operation:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-python",children:"result = ctx.lazy.join_all([op.catch() for op in lazy_ops]).resolve()\n"})}),"\n",(0,o.jsxs)(r.p,{children:["The Return type is ",(0,o.jsx)(r.code,{children:"list[Result[bxl.AnalysisResult]]"})]}),"\n",(0,o.jsx)(r.h2,{id:"examples",children:"Examples"}),"\n",(0,o.jsxs)(r.p,{children:["Examples can be found at\n",(0,o.jsx)(r.code,{children:"tests/core/bxl/test_lazy_build_artifact_data/lazy_build_artifact.bxl"})," of buck2\nrepo folder."]}),"\n",(0,o.jsxs)(r.p,{children:["Run such command at ",(0,o.jsx)(r.code,{children:"tests/core/bxl/test_lazy_build_artifact_data"})," to run the\nexample bxl script"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-sh",children:"buck2 bxl lazy_build_artifact.bxl:build_artifact\n"})})]})}function h(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);