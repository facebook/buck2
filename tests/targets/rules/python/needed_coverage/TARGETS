load("@fbcode_macros//build_defs:python_library.bzl", "python_library")
load("@fbcode_macros//build_defs:python_unittest.bzl", "python_unittest")

oncall("buck2")

python_unittest(
    name = "test_pass",
    srcs = [
        "test_pass.py",
    ],
    needed_coverage = [
        (100, ":lib"),
    ],
    deps = [
        ":lib",
    ],
)

python_unittest(
    name = "test_pass_specific_file",
    srcs = [
        "test_pass.py",
    ],
    needed_coverage = [
        (100, ":lib=lib.py"),
        (100, ":lib=dir/lib.py"),
    ],
    deps = [
        ":lib",
    ],
)

python_unittest(
    name = "test_fail",
    srcs = [
        "test_fail.py",
    ],
    needed_coverage = [
        (100, ":lib"),
    ],
    deps = [
        ":lib",
    ],
)

python_unittest(
    name = "test_fail_fractional",
    srcs = [
        "test_fail.py",
    ],
    needed_coverage = [
        (80, ":lib"),
    ],
    deps = [
        ":lib",
    ],
)

python_library(
    name = "lib",
    srcs = [
        "dir/lib.py",
        "lib.py",
    ],
)
