load("@fbcode_macros//build_defs:native_rules.bzl", "buck_genrule")
load("//buck2/tests/targets/rules:bzl_native.bzl", "bzl_native")

buck_genrule(
    name = "check_test",
    out = "out.txt",
    cmd = "$(exe :test) > $OUT",
)

bzl_native.sh_test(
    name = "test",
    args = ["arg1"],
    test = "test.py",
)

bzl_native.sh_test(
    name = "test_fail",
    args = ["fail"],
    test = "test.py",
)

bzl_native.sh_test(
    name = "test_with_env",
    args = ["arg1"],
    env = {
        "FOO": "$(location :file)",
    },
    test = "test.py",
)

bzl_native.filegroup(
    name = "file",
    srcs = [
        "TARGETS",
    ],
)

bzl_native.sh_test(
    name = "test_cwd",
    test = "test_cwd.py",
)

bzl_native.sh_test(
    name = "test_fail_extended",
    args = ["fail"],
    labels = ["extended"],
    test = "test.py",
)
